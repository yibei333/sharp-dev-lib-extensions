using Microsoft.VisualStudio.TestTools.UnitTesting;
using SharpDevLib.Extensions.Encryption;
using System;

namespace SharpDevLib.Extensions.Tests.Encryption;

[TestClass]
public class RsaKeyTests : EncryptionTestBase
{
    [TestMethod]
    [DataRow(RsaKeyType.Xml, 1024)]
    [DataRow(RsaKeyType.Xml, 2048)]
    [DataRow(RsaKeyType.Pkcs1, 1024)]
    [DataRow(RsaKeyType.Pkcs1, 2048)]
    [DataRow(RsaKeyType.Pkcs8, 1024)]
    [DataRow(RsaKeyType.Pkcs8, 2048)]
    [DataRow(RsaKeyType.Pkcs8, null)]
    public void ExportPrivateKeyTest(RsaKeyType type, int? size = 2048)
    {
        var key = _rsaKey.ExportPrivateKey(type, size);
        Console.WriteLine($"{type},{size}");
        Console.WriteLine(key);
        Console.WriteLine("***********************");
        var pub = _rsaKey.ExportPublicKey(key);
        Assert.IsTrue(_rsaKey.IsKeyPairMatch(key, pub));
    }

    [TestMethod]
    [DataRow(RsaKeyFormat.Pkcs1Private, "MIICXAIBAAKBgQCAfh7TU1BWvpkmZGNZEk2vKusWwFfmT2LpFSfCK1hUm+9rEw1TZj9BabLJRfw20lxdS2zy1oEIduVHy2BeJKrYL3BlyKdd3lkHh3muHaHcos2RJxQakXkzjwccsGaev3lrSQZIvzkfsoHDHyXYmZON4JFw/BYZq4SNlrhogEJymwIDAQABAoGAB76SQQ5ucyv9sxCt5Dp0MDCYBsEFCz6RqZa61LskEcVsQrndPb+V5G1odzUepHc9Veor4N8I2+e+nfsmDcaL/XGwxl5G0vAYfL3m32aZRzK/twS4253fqctkPatQ0cARRrYKgEUs+1DYhgllLetTaZVOoTOuPQUkbazUKZgt14ECQQCiv4YdSFkGbMo0CvJd3iJ9wA189/WUDGEAXqqwDaX/VRAdTJmANT3t+UDX01DFp98AsWyLHnC4KL2qe0+UhjS7AkEAyh3hanvYdCcIamZ7nw5mzBL5M6Uhkoj4uhQXS8E/NN0DuKxxcDCRrG8s/mWhEi6CG+AdLbsU9uTlv0VdmPHLoQJATtrRlpqZV/2aM4EiUczxlVBauLRD7wnYbh9wQIE8buy+NBQLRA2IBigA/RHMTxi5elJ9LyL+ppxG2bWJp4MnRQJAR7vrMTvbSv4/gmP1JDKcUXm6cJX/IF70yDYxPnXL1RtMItMxP7w9N5INygyP6kAPdY1JTd3ERwxeblBUM+A9gQJBAIKY4a+lN1ArGwklfOf/Ave9+wa2juALcVOIlU/2GLhnhYgbC+kP4MfCKxKMMWEI+TXX3zCmIFxUrle0yI9YzAE=", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCAfh7TU1BWvpkmZGNZEk2vKusWwFfmT2LpFSfCK1hUm+9rEw1TZj9BabLJRfw20lxdS2zy1oEIduVHy2BeJKrYL3BlyKdd3lkHh3muHaHcos2RJxQakXkzjwccsGaev3lrSQZIvzkfsoHDHyXYmZON4JFw/BYZq4SNlrhogEJymwIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs1Private, "MIICXQIBAAKBgQCag73hV5FTkh+ROZ96GTmPDIp4V97YLV979jzXp74p8mHFh+WvRcJRzTmJX2ngaBtewPp0YIm4zAKOYbw6r1eG4IMkj7zInwFVcWBS+6z+D9RmoX5M0Mc721v4wIlC35jxmq1fEbDEog3pTYWROOSNRwC/mYlto1bYP/HNmqC7CwIDAQABAoGADDxLHfwMMwegM6TSKcizk83/bRYwPFgjdofXkOWPRne+IaE9oUqEimvA7E2U7xiaCj/SgBgLmomf2NyJG5s6SACrfMpM8XJ49lzIjvDcTxVbp2rvPTqgtxRRrnfrU3oOrsuQpJEgTc2jgpcc2oyhP+Dj+urgVgwLl0Px1LC/DukCQQD43fws7EYwBtxgVcUt9edqoABHGxI7O3JCpkpa+eGSRDKJeWLyFCQefR4Z67AOKnT+zARoMUvtH1HbYUjaoMvPAkEAnvF2kO8B1EvGYJiVymXYwQ42xWYQvlPH5rXW9vVnxzK7s1ur7R84Yjhm1gkM6gR5Wq2peW8bMrD5PJp8CidABQJBAIgjj07X1bFyH14HrXzt9zFJ470CHyAN7fxt0WEhLvd/nRG9OJZq1DNliHDvkHi/Ww8Ddim1Re6qYnIbLuqCadsCQDLn5y+YPR+/fTPm6uK+J+P9J3GltOsgbj/oMYc7JhfYmeFiFPiHLUnYAqe+klJJSIzQXh00hqN/pvPQDrY5x/kCQQDXpoDCQelhgDhwaYgZtxfIhF+UTDLSTXNp1MNtI5xCRmVvwA2f7WiRG9chWpxdc0Mo4llzD0RENFO2d/ZDzJhC", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCag73hV5FTkh+ROZ96GTmPDIp4V97YLV979jzXp74p8mHFh+WvRcJRzTmJX2ngaBtewPp0YIm4zAKOYbw6r1eG4IMkj7zInwFVcWBS+6z+D9RmoX5M0Mc721v4wIlC35jxmq1fEbDEog3pTYWROOSNRwC/mYlto1bYP/HNmqC7CwIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs8Private, "MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAKzErZMB6OwXyvyapeGg2H6YPQNFTNBVCIkkcMOFVr5afAfnojFA1BeUaGrtw2tSRnyVy1lks+rLAVsHJ8X1Sgvkk1YS57/pBKwSEh5x0bS6o0heuS02Xr6ou7yMHDfkYkWXp/gxAt0bsROwVBACK8nwpKMLIrsK4elF8HMogMl3AgMBAAECgYEAlD/AYaEF6XERMWjSZqXKn/aqhB/3Jd2RkXy/dkb4hCbIv0+4EWN7mzAx2W9kfLcA3O78qxyKdjL0WtPtASTV/60lM4BvZXIsHjckTQzVY098iP8sH+PurKj4DyQ41y6xfrGqJ9aY2DTKZSr6KRYslMNQPDxzwib2kIfOiyMcOSECQQDdNXtqi2Ck/4KkVO1hMPX6NcTowMK0Ur4Wxti3Dc6Y8NlHdjhrLKmjcc1ruWMn9/ai2J9k/7mBDP3SxsGnIOWTAkEAx/DVg+lWZArqApqqpCCy7hi69o6borO9mWHxajTDGn6G+ZtWDE1nB7Qvds81Mxv5+vEI/9DjzxhsNoNSoQr7DQJAQUn6viya/rgHSBdk5K29u/bIwmW6UdymDDTuW8DwfEWB68yhxEgvXXVGSwgxkudl3RSQnw+3IbbC58YP/BMCjwJBAI+o0rF6SfGOCgAfA3b0a7w6FrQrWVZ5UUTRI/YMvRbfTLoyS4yBXQMjC2uRjIcRlfchkzbD77uQr8gnaYp+6k0CQHuvBoZNPoNAXQy3XQ4T+3zcoyiD+NqSamlmeUbehP3en3U9lys8qYeR6qDv93sB+p8ijUsPL2GVPk0dtL+2j7E=", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCsxK2TAejsF8r8mqXhoNh+mD0DRUzQVQiJJHDDhVa+WnwH56IxQNQXlGhq7cNrUkZ8lctZZLPqywFbByfF9UoL5JNWEue/6QSsEhIecdG0uqNIXrktNl6+qLu8jBw35GJFl6f4MQLdG7ETsFQQAivJ8KSjCyK7CuHpRfBzKIDJdwIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs8Private, "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")]
    public void ExportPublicKeyTest(RsaKeyFormat format, string privateKey, string expected)
    {
        var formatedPrivateKey = _rsaKey.Format(privateKey, format);
        var actualPublicKey = _rsaKey.ExportPublicKey(formatedPrivateKey);
        var actual = _rsaKey.RemoveFormat(actualPublicKey);
        Assert.AreEqual(expected, actual);
    }

    [TestMethod]
    [DataRow(RsaKeyFormat.Pkcs1EncryptedPrivate, "123456", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,1DAE406D313DADAF

arFRF+a+e/7YZVV+62gyycJNZ34nY5xfF5G7/B2fTQxaYpnsslGc+dzD6H7ZfKJ8
jqoDodeo/fSnDrhZqZmrBMXdKbrtGklQgmeMgCecdHWu5XkW/jM2o49oIx8WGxwG
uDsEynXhLX2PWu901SiJfbzNURdIglAJyjzVMBOcXUtScEKevJqTaYx+W0Toysr5
ne8UvAz6CM8xVY8XUCcTba/WBJMISjm2725A48V4xTDzv2Dko0QZ7hdhr/CyuFwg
jnkKBX0J1dEZqC6df99IKf47ftt3QbNiBXaRO0GTDBbm0KecjbRUMwQLKeiQcfrZ
OaMq5VTcqmWSO/gF9F5ud+6xDkgbz06UVQxJ8G3Ix0Xdviyte+/YnyT7m0SISopE
c1QXf68gPS4URXvU/Zv6d3yUwMa2F8kPNQyqXviPf0X6KHJ6CdXuTparVoz7Hk4b
2741DqvbTz0QCW7KfB+8O1GG/5/p3gy8dF5b1PNwAKvvaaVhsijs4qg0ALNgOF/2
xfdTiO3XWHMLG8WfLk+9bF5c50eGxYogT4fopV3myw1xnJww6/MuOieUKBwsxuBf
TezzPUVXAKKU6y55HhlCjzmNffniIumDb4uzJvriVWapIlbwf/YWm74mb9rTC/Vv
uPNspIrNq6UtQ5+zo4tLI0FnVGpumi6VCYsKM0iXtbpWz1dZVxOWjqgW3dUU1w3i
CpJAS1slx7ODv9wtAPztAvkCTdAfCCOu/8+yQVsBgBIbYp+BmKVcwZ+H7/q4+2kA
+SqoksDpBK9sYSpW6HHj8nnNKQGfCJ3csr5Evna88avfvIsUDkV9GQ==
-----END RSA PRIVATE KEY-----
", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC8Vu5mT8NPRKascYHcMvLoX6/3tWLjRQ6mw/W220g8/ZOwA5ChhSt+w+X2tJZ/jjcR9GrXNW0pNcMO2uQatebal71j37d9qSKKizzrzp1fbHvyG7MYcZDiyMQhuYJwjL/QRJp1uYu8wjdIe52ilBkaToQ4ztW0QH1GpZavmqMYQwIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs1EncryptedPrivate, "123456", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,5DB6E9284443C7AE

qH5A307YENHjl0Jli6IOUTsMhSI/0DAY90L0nq3u53pngmrrjgLHYF/fiGTbPUal
xwctKHPeDszv5Pd4bA4J/473ZbKvBbZsMvSObe4J6X47vRxaYeHOFQoiZNTVXfy9
cfAG5snUozgwRiU8ArYZIqeiydOY2nnf0Us7XZ5Q5swi6xRbGR2u/UElOChdtc1R
hnhx/t3tkolHwhlcdhLJQa3prdyydqjvcwq+O65wM+RGmuK/TIGq3sdOhD3VuRwM
317PkvWmZYdGv6RWzoFo8WhDLXn+J5r/LAs47wD/84rdVDZf8Qx2t46lN1xkzeYV
C/i9mZLjx1G/BeP3GvtwcegWf5T+45ZwwUVJRp2Ck7Csj+aDuSwL8IDfYhsgy7kf
o4rl/Hd9L5vaxgdx6Ffg6KtIOzw8h0fJrOO7F7oiN0yMD4KEaH4fBHnuFK84Z6Kv
WpsmvuJi5AaGPu0XbpP5OaxUPD1DQ07g5sSQOIWAOyZ559I0O1VXg41up9kPhA3B
9RuTzxf8M4lJO91q07FZ3cYZNbqBHsscmq8NLS1dOWe98rIkhjQmP2mfpuH6C3sN
T144H2oYDdPH0IPjHcS8kR8cIrS42mfJF3dcFwel758mq7lsPkp/QOapVm/gH4XS
tq/PFPj64JNHTiNAXJlzomccNx/ebvwrDgxuxN/TEhUWom8Xwwie0ZXxFrG6wGpF
BjNg/zZ24gMsYXtPD7W/3ddMIR/snjqeXw8aSmA/IYqe3aEvyjeTPJqSk0XH1O8W
srqMVkLOwiDgjfCTVgNX7YrM8TaLx+kdTXgAn8CXIdM=
-----END RSA PRIVATE KEY-----
", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDWiVqJAEtAc/iwwPZJ4yy+HN8llZImIQxSZjfxjF1Xex9939IZM85LoGYaSuNzRsAMtBTphk94Jm3FHQ/F//DqEW+KdMUfMOEOeOLYuO50XIjyFXj819eYTHk78/RiTPlmFXJVWXRfZjtWG2+m1zd1Bmwcht2P17CkVNbT6jJUsQIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs8EncryptedPrivate, "123456", "MIICxjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIj6oUz6vkO48CAggAMBQGCCqGSIb3DQMHBAg6+j+N2QOqIwSCAoAL5/79D+Q8NuFuX9ad2scTeybaS2lVSA+3r95uElqyUkOtFyJJmfKQhQZYg5hrksqsAZRy5Sn2U6thpQm92+ETVz3chQxGjqsX/mM5vy6X5u+Uw1nKk6FdJtfnfFZozurvUt6p+yjaQcLMDFYggJeMUTeGEuV4TZ5d/wO8VgmWjkm/U9alsqPOmcW1CM0sacPVnUGmq3hJr6iOFy5/Jz7UKdkUFmt5PIwEy1r1Qaot7l5JH/43bxDaK7gVixVrpjgxjZUwhpvAkZDnmZrcgrF9d6+1FMIH4oWv6zuVEBZKEutWATvYn0IDE3nyBJuEpGo/YsLrkbuUna0k6IbaZEsJX3MtVs/go5iLstIu4o5VBURy1Vr6M7vloF9Xa6QSV0/PEveqfhBpnOzs5IA2s85h/wmbbTNLD2W2FNw45WcjjHY9uKjxtXCeLA20ARb0k/4JMNBlXX+u+YnKywNziF0SlKOwnhoMveA9QkiMiONr1uF9rm46gvEqZdWCtSx/DQXCa7dLXNJ66DX7llIBuca+yTkfYund2fyyOvP3+nNCVsVZTPl31ZarJwwn5zflBUzCZPAtP1URyI5hQ927NpdvR89RfonHE4Ka6iXtXHCXz0w8URqruhmuJ0n83ercPYG74STQJNc6w564L7EqjwnWfmbi8vi7pXhGdcn1N90DGwW6nBndiqJsI17y0mZQbjo6+Jx3mvV62eftJYnebleD+QN7G6Ycqqh4ieOgGhdi2LLG5uk3Dyokl4+Fl7lScRGlicchCr48f9dd9DHQjp27R0rwIs+k+fKWiu6/FJitO/g36geNWQjDvSIU3fHe6OVve/tt/Zlq9uKZl25DUmGF", "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHm1n+/gdT5CAOtFQCYN0PVZJ2PELaOEVEKLU4O4Lzeb1ZORfZCYP+ewUlpAw8hu9Z9U14nC0GfD2bV1V6I87iLs6w27FBEfhityAp3Jl1GF9soi2r5L5Bckmh9yyXwfp02BKMJKyaU6AbYN/LfxFg78Z8sFp55uZ/tHvRXAb7HwIDAQAB")]
    [DataRow(RsaKeyFormat.Pkcs8EncryptedPrivate, "123456", "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")]
    public void ExportPublicKeyByEncryptedPrivateKeyTest(RsaKeyFormat format, string password, string privateKey, string expected)
    {
        var formatedPrivateKey = _rsaKey.Format(privateKey, format);
        var actualPublicKey = _rsaKey.ExportPublicKey(formatedPrivateKey, password);
        var actual = _rsaKey.RemoveFormat(actualPublicKey);
        Assert.AreEqual(expected, actual);
    }

    [TestMethod]
    [DataRow("123456", RsaKeyType.Pkcs1)]
    [DataRow("123456", RsaKeyType.Pkcs8)]
    public void AddPrivateKeyPasswordTest(string password, RsaKeyType type)
    {
        var privateKey = _rsaKey.ExportPrivateKey(type);
        var encryptedKey = _rsaKey.AddPrivateKeyPassword(privateKey, password);
        Console.WriteLine(encryptedKey);
    }

    [TestMethod]
    [DataRow("123456", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,659EB83DB276C6E7

qxZ7XHN0I1RFyUYG782s0L6N1YkgQBGjBJQ/MqVIX1jJbGjCZURqghYja1imfps6
uWY0JLF4z3+PNQ/Eq+8UBc/N9QmNvaREyNiR8QL0gf/RG2rsmmoSVGc+2VR385nj
Lk0rhldsBXCClp70GYvDoBx3ofoKsmVXAfTbHrh6M28YSGlebWeBEkiz73DFjcgs
99VY9ihLMeIjOGn1LFS2wgh+08LAm/wPxGh9VZb/UHxsITYM3zZlKtXM0us5ZFgV
DNGlhNzd1MninY5aWVyGHLrO3qzcUOwZ1orWPjULaIM/SfDTH01zb+JF+MBcCOtX
hTBSZoYnbfOAZ+cKAI3hU2hkH77+0+T0qdmZ7mxzPUTqevS3fhb2dDvuV1A3LIl4
GH2+GRiVdIyI/lghTeELpKUgfILovlpNPNOA4aZUo2EdYYiHe3ySRnNFyLJBnwdo
70kpN8D2ygl++Rli9TFtXxAE91RBDVNfFhcutEJBhLop4H75Nxupo2X3Up73HvEs
ifouEVeEFSYBay7pm28WuqXWdQWXJcYiKdfdFQOFVAvKZn2ld6XNDSpG01uOjeyI
TOKQWYuRIc7oKT8j6GDIAlCmpjnX4i1UbrIuTqHWGApPHq5TQWmbTwXV0JI2eaEC
Y+YxFQiGdecQGSNRxRP9KoQDxmjchtBGs/mqpJZ5z0hgr1zvXrCTtXllJ6NgqMGQ
wwwqB+MsHSrbu0ZwvJBJSc1fz0fTYllaMGLg+us5q5lXGalk3egJ4DILNBT+V6Ma
k8HJYT29GW2pTKQwPhCtO996o7P04CUA2KGfHKFFw7TFFNenS7uLgA==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCJ6FpTnAw3nUY4fBtaYWr1Ibr/
/HlOAk4Fnj/OJnpQQQnLaVTT8oC29Z5egtKpftahVLGRowvkAb1sIpyGa0g92QLC
iwx+4ZYjJ6+cA0zA4GFcKwM8Lin8EBBnDIxtEh/+6uvnnu6nqWbpVZdMYGXxkkBM
HM9FUbnrY4HR/zUxOQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,E5CA45E965497402

mIFau/5f+EK/8znpjEIk2ucbuM3Zt/8xcn+aIacCcSvdOfJXfnw3Wg9b1qaSyMla
6LcLhH7gl41PatDTrQBVSHmsB0eTY4tnMWsUcFgPLt0xVc2dOxG1RyilPfyuvIf5
fxhRo3vAogjD0ccbWmQIOU0orUItou329f7Cp5rCdQ6+YdoLbKuJq7kNf4dzUy9B
ooWDhzpmlbs/9nKWsrI4BmPIlpo1WG0UcrGkg2f5LU1GladroyjWOORBsvLWaOda
X3l6PEJi/oi86GQUoys7AhERFQjsF6AD3drLtadtZPNiabbV4FVYcHcY+M9VmEsC
8xI2bSC+qZeZY8Yj7b5jbGRQj1MeP8qTR6MBYCCxU6eWc0Q9zrobXV6QXyOPQI/6
F0FDbse0PgY+GkaZm0ElRcNXDdLO9sk3LyA5h17oZiLe0haAOJiXuSabH0jGMwg/
ZcLajYLtbVEncc1TVpBp2bxHdcbA45717lXHHkJR4ZoH2OG5y64mUaE++I11mJTB
tSUZwYpYAkypxqPJXBZDmaUP7oVPhjbV8AaUGUYMWIzwDBmqQYmAxp7WJ0kp5/Gl
7ek9hi9YzRmGlinlpagMpcn6+y89NbSDFcZADFQvI+oIeYUz+4CXFgxDpFISmXz4
18pEXCGeIxqFy3SFudIbF8AVL9Ftc53DFcDmhvJqclWeX39daAT/4m6A+eqOf3DE
7VSOFtp2d7B9JanaZk6XHO8ueHoqV5zvLDqBGbPiJ2iMNWna6Fmralsc8LRSGbm9
wA/89dbjp+M+FimkvfhfYZfAxAG0ZjQM+fxUKRXSCKtYSpbSiORfXw==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCUKmN0T8VVYte2OELxe2VKbMv3
Xtfi4CYpNpRQt2W0GNnjPvrzHA+q4qmc72XCfkBqwhGb2pRtCyhLINTek6+WItyQ
ZeSNHLbVF46Su1sh7vCFlb+nwVsTyLGbNvxVLf4UiX8V3g+50939X7U868iM+Nff
rwfAV360EUmmiO8H8QIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", @"
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIICxjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIotEOf/9XG3sCAggA
MBQGCCqGSIb3DQMHBAhuqafGD1IetgSCAoA9pzPmUSiAkvnFU+xOWZi0xR0gY/EK
RvHeoUNGLuWlD1tRM/LzjJHGbU0E7O3cla+6CIHs/pvxj+Ty55IoMa8VRfDJ0OfA
NkPTpvcQUWuTQbwydEaC0aSS0GUd5vna65kN4bcrZJsNbky7sZGG3MBRAvO1hhOs
Ul6MPQiD8MTuLNYCY5U5/OxkuQu86VSRf03DpFH1Do+IH3BJTvSP+Gj5jJQoXRVe
yUBnKq0Q9NTOgKLLEIKgavVjmg/h10IUWzqBKU86iSZ6i6lig4VdmMeW4Z9l1Ad2
00MhhK/0S6vF+2u90lQODdG9ABoHF4qDANqR552r4w688E+y9udcqluukhuxjkq+
7kJhawB4SnYVrce5QxcRPmlOhOrB8YOzimuXHb0YCNEAueYA8U/8r9e32k3QWoPe
DWpPndbndy0L/mVwCsApszveGoFgrk3V/xaZhOjC0muQPmYaYtHtuWyb++yK9YZg
052UfysUtpGN2GuYl66RQwP7IJ+RY+JcqYdHomzhcwuTx9pQ42thED7EQNc3mMdK
fh4TnVLI3YtacJVSTiUH2FDxJrPKSLC251qCDPhFz6Jq4a1cKnbsGolp9cW8ej/D
oU5auHNItEM+WNXZqaft4npFACMnRqSDikfD18oHMG3EfnGeTXTFHUzq6Bk8iLSF
6dPOxsGurMjOEWrwtiUZ/K1lIbAK7vq+IJ+C7eGQbi4rLcAcXgrJEBTEobNGj9p0
sLvXVqEusXkfBLK1elCM4fBJWyIMM8aL+oZYpbGHkMNb/Brz76OotJGhwHtChnTW
RWX4feOHYanXb5lHRIm/YStdu2TgEXNW33ErE526DthcK3BAG2fYFvyP
-----END ENCRYPTED PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC4ftMxVHRBp3+tFZumn2oF7onb
mj5gbCZXWRhJ5YTGU7hJGkExAsHDHSton1F0l/WyH44ROG9NIKe4yozhbBrVGrgV
iR1QgrGTUkvCk8lnQwGpQGy9YoDOtxmE6q6+oEAq/w9+1gNGbf5zS1E9k0N3Airn
aqokdtm2vd/NrQ0cLQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", @"
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIy7dd+zj/haoCAggA
MBQGCCqGSIb3DQMHBAiulMnW6wdpQgSCBMg7Urp0XmneldlkQTZgO87/NltdpFwM
SPfApQP5CE3Eiytz+E2pLJiH6mlk51AdbQgdI2q36nW4ZjXLHcI0LIIleBZED/Gj
1/PGLS5c3q4XwFKP8hsl4wASKdpZD+HiAUXGpUTKbt2asVEFTFIMlIYTmJN9e056
+TYAAKq5t/ZCscpJJMF7Sm40139lVTcxqcG8u7fsNqgPv+qbB2b4ANDC46xrdHtm
86xBiAMu7lAxnrnZHBiY+kDYIn1dCVgRICn7Fuggj8khGIQtDmQDOZbwEkFscNHa
uNpp/tKA66KblbZS7NVFkTKsG4q8JUU29yeAIfXegqzUSWxl1HdmlRdbfukNG2UI
aZMNEVh3gJvQPHSOMVPBdOHtnqElraimQNE0nRN8sa71UTVz/bpFord3q7aC2ONR
RP/Y94dsY3qcc5PQ3EaqT0Gz7NePUb08CYWo7wbNSUqXnuja1a0IQpGGUaNefxwJ
FC+b1piHs0O4bwAbSAGFAdD44Hgb55D15n6k4zY/nME6/ve8U3ipBdVQDOFGlFGS
ut0vCUCIdLrzIYP33F5YLSAIlLhn5mEUnycxLMurba/wrz8mXXe0cpYF7alE0JWV
yv7/eIH+KGiDUy9d4jN347vxHtQ4QIJqRS9V58ipfKZvUyGYgw/FCcFj3wvjUlSs
ZmQqj5xtXXKg+1decA8uafhRMkhkD9Ud2zaVfBg0y8lH38j1Hs+bZFS7wZM0CjAl
Fj1M4lYwOJuqkTY75r0YCpbiFN/ZB6kokDVgNqbI8yncj94Lix4Mq4KuLRPEzsLU
I1sHWAruynr0P/jxXFCXmcqfpp7Gtv/9C6vxZ2p7Z5UC9TGnmK8Wv/rlzDaLl5Ke
mcy5gdqsTynW2piYlL/CqD6w5MfehHAUNTjbE+T6zf75k++RmOUPzYp92XE6Kq6s
VaLbiJ/pw29Dd9EjLSRLSEy0OmQwwspuKg6vMMF47LGs+lPAJ3FCGdA3arQ2GVEU
gAGKQECHTnlPPk+cQVrSI6Q5HqiBI+4camewL2kjnhrL/zk7BIGILIQNDvILxivz
omd69aiiONywM8EvSqn+qCOPvNqY1QjMcWA1H/CPsU3N5U8G6K28hcJSc5nP2/I/
jKxmJ222vQfSi8rA3TdncCOOWltGfqrBmEHCF4m3pWzzh3KIE+8TiH35dhX+muq5
1fH3T1oE57r5aCVhQ0zbpvvkAzk2Twdx5FkIITQnsAdQjcIzoyIngBnjhCjDLawv
h1NXbh58oT1dN4AAI7BYJCX02dhjcRFoi2IA4cgmsctOGYfe0PkzV+k1tZDl4v+k
sE8sNcNxuvZ6NMBrjkq5K1eMTdB+BaiuqqGErZqwZq/nNB8bXtDdM85CsuDE39DW
HcFUmQzHcc9Elfwpp9iHX9IXqkaFt1YkAvdmD6clXlk4mHGznzWWUb9trQT+K/6j
ye2bFkKuye/7v4jSsryxP8fh+apjQmrxJlCr6AE1nQySzSsLkJ9EewHF82n08B9F
hbDYz4ACZHf3+1KcVxQnMcOu4jxCjmNnvXi4K+OhyNHzYP95vgOAV4Cz2IJbrHz4
YOlAEg2KkdDs9uG9h+uTTy7YWVOP6W7Qa7z2PCdZYmVgCLgjJxdUA3VgFnGMqicy
md0=
-----END ENCRYPTED PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtjnFC7d0YZHM/CF7winn
Lhy8KRThFsZTnr0PhUSaZ2oWLbChYY+20sb1TaZr+oEyuX05ntSkLs5U7yzLdbfL
aV9TnIlQlMtN98x+zfbBv4g+lj9IqYDto/ZfgLronSiJ0sNNrKH9o8mq6090QLph
32YId28YpkDmr2hqtKcNE+ZzNlCM/iNOiL9udR7bwAZMrn0ZAnOohgOj87AAJG++
onkDRRIBASgOVAzZOxR2KcZCYqFa8ti9PHayCm3bfqAR0kHcelN9uZa/vBJbE7wv
Sh023d7INLz09UqK/NAU+km3XUmOOxBlz9h3DkxriMTZJq06IQRuAeLcxRs53KlE
mwIDAQAB
-----END PUBLIC KEY-----
")]
    public void RemovePrivateKeyPasswordTest(string password, string privateKey, string expected)
    {
        var decryptedKey = _rsaKey.RemovePrivateKeyPassword(privateKey, password);
        Console.WriteLine(decryptedKey);
        var publicKey = _rsaKey.ExportPublicKey(decryptedKey);
        Assert.AreEqual(expected.Trim(), publicKey.Trim());
    }

    [TestMethod]
    [DataRow("123456", "654321", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,7F5818AE4778525D

l3XDv30IAQF7lj6XKV5qKRT7o8ugb9Rd3uWwug+0q6XTjgyJS5FQzqvY44EQKW65
fnwrW/ahgPx0TwneX7cSSHJ8994iJzWAjUWJqnPsprk90rU8uPm9lIbheqkjsBZo
fkS5TNw/XQFBLVllBEfQsySGJen0cyaz+A4wXyfYMMqwwNZ/bmDm/2lmay9+UW+P
dqnbV/TJuLiwC9CjbySR19ws09jXpmVLlkVYpVj0l/y2ZpdoWOrWEG5TprWv3tHR
NzhAI9H4eWqtBzepMULXqjjB5TLNsMJ1CVgj6MXlLv0i2SukJkUaf45awWvUQ4Oj
b+GncwzRcOQwuApyaovZ+aMCx87OK6IM2aSEWBjBtpQ8GtDfIKbqlpg9u1ivAgwO
wOCS36caEKiiuMwNpZO489NIOugFDuLAr/mYA5njMzPhj5Pe/cRDDy0//mL81JKz
uX7EdCWN7X8H4aWlzLGt64kmsxl67YIK1ICt2c5vMDa0W9beMOfcRmYPdC9noFnh
J6CVLAzAwhErF+7S1JbdmEbi2/FVDvpZ2wRV18+7GnT256b9JY72BRyqe6R0+yxX
7P0djj/AOwnwiYLEeGYmQcmJG+J4CvHRh1MWcKFwq8e8gM8VSvkdhLJGGfuNF8Xw
+3lenH1HJX9srYXUxaSOIk3hjacORK57dbDCIkFWIaO0kWh4JA3CaMQ+PGwfrUv5
7Fl/biByDZmc09WAf5FmPX8LbwHlM22qL30SFP8/soZoIAt86qyDebywkUnn4rwP
B0C4MN/QjqwTpJ8QS+UE/te/kZNRJI3HbOl9kcDp0RXaBn1wIFeakQ==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCtqVPs4kWg+DlC3s8MUqw/7wSb
cxR6ud4C5yB7l+wwa/dSlN6A6pRPItZAHVM81HMlAVw/vq5oEoLwUucBgnHPBS0q
TK5FZ3r+y8L/ye3mCo+GNHGn6p2urlOs9NbCHCfyCB7cPcKMC7R7+SP3HqVLTIrU
Jq/jccurtc+buGw+hQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", "654321", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,9E450A6DAF954744

wsJAafC12BSEYab9C1FiNhCprgkjaz+XjtAU6v0g/BULBjZ1vr7sSP+MkIF1EPUC
ecfUkpi+MIO3IdlURXIAxnGAX3VpWys9qhpWv7FpMq6narKSpVoj97f9XAky1shS
u0e0r+KzGWXuuYUe4984rhxL7zS3icwOFIczW93SgUN/gRZtuQl74nGuN/krYFLZ
XQRlY9xGItPnDYcTgcGUBNOTMbRHiwd5dzKxBTXSWSMappXLn1C0vCxAJg1BppJU
BeNjY2quSUGzVpPLu6Rx+olGC9MFD/VRT8qfvL9rao/+tUA143OnijBLQSHVsqCZ
Juhdl6ij3v9lIvODp/saQXs++yvzPZ7RySP0Xc04pJFwSavQpnz3d7zooXdXmTXY
pGFNY+dhdaO2Ar7syxympkbJk2OByM58Msaf3WC7XPUoBJgGtrZ5MblXBbJ803pH
BmC8uFxr25sMn/F1eehjYNAb4dTTyUzy49ybyM2nwLZ8qXYP626R/3o0pAJU9oCR
/q6A08tP+NGTOxn/PwCUdsIoCag9L8IVNS12Q60T+Dcua4gchQbgMGDJqLPLsoXI
vAbdxCoPhqJysDyTyT0PFHStR2iaO4+DhDVl9B00OsJfK6vrb4nGkr2tnBu6x9FC
I36GQ8SuCCyBmysImI8qlM1diOxazqXDOrGq0cutLje210O5MbAB8RNbG0vRphCj
A6PGo1I/wyogHQsDmGtJYcU3W4U6FXJAbVT40qXnQGaIrgQnlm1PeAezK5wJMj7x
SNmgxfO7+FkPjBX7m9nGAH2YL1a0iMtdpMcLeUc5foDgSKAy/CaBGw==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCjT0s+1oQytQdBI012vjNLlFqk
sZ/PAeME4xRP9e0VGWi+laYi5J7ojo7qnk/ILPnd4Gbxb20NgB6SRESpMN9XoPdr
BwTcql2TM0b0Z9fDKE9Z2BzudLpZ5AlbaXuynHR6mFwFZgbsOdPc4lbcdAll1Jpt
51lTYzCiukn6Yc3/kwIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", "654321", @"
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIICxjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIotEOf/9XG3sCAggA
MBQGCCqGSIb3DQMHBAhuqafGD1IetgSCAoA9pzPmUSiAkvnFU+xOWZi0xR0gY/EK
RvHeoUNGLuWlD1tRM/LzjJHGbU0E7O3cla+6CIHs/pvxj+Ty55IoMa8VRfDJ0OfA
NkPTpvcQUWuTQbwydEaC0aSS0GUd5vna65kN4bcrZJsNbky7sZGG3MBRAvO1hhOs
Ul6MPQiD8MTuLNYCY5U5/OxkuQu86VSRf03DpFH1Do+IH3BJTvSP+Gj5jJQoXRVe
yUBnKq0Q9NTOgKLLEIKgavVjmg/h10IUWzqBKU86iSZ6i6lig4VdmMeW4Z9l1Ad2
00MhhK/0S6vF+2u90lQODdG9ABoHF4qDANqR552r4w688E+y9udcqluukhuxjkq+
7kJhawB4SnYVrce5QxcRPmlOhOrB8YOzimuXHb0YCNEAueYA8U/8r9e32k3QWoPe
DWpPndbndy0L/mVwCsApszveGoFgrk3V/xaZhOjC0muQPmYaYtHtuWyb++yK9YZg
052UfysUtpGN2GuYl66RQwP7IJ+RY+JcqYdHomzhcwuTx9pQ42thED7EQNc3mMdK
fh4TnVLI3YtacJVSTiUH2FDxJrPKSLC251qCDPhFz6Jq4a1cKnbsGolp9cW8ej/D
oU5auHNItEM+WNXZqaft4npFACMnRqSDikfD18oHMG3EfnGeTXTFHUzq6Bk8iLSF
6dPOxsGurMjOEWrwtiUZ/K1lIbAK7vq+IJ+C7eGQbi4rLcAcXgrJEBTEobNGj9p0
sLvXVqEusXkfBLK1elCM4fBJWyIMM8aL+oZYpbGHkMNb/Brz76OotJGhwHtChnTW
RWX4feOHYanXb5lHRIm/YStdu2TgEXNW33ErE526DthcK3BAG2fYFvyP
-----END ENCRYPTED PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC4ftMxVHRBp3+tFZumn2oF7onb
mj5gbCZXWRhJ5YTGU7hJGkExAsHDHSton1F0l/WyH44ROG9NIKe4yozhbBrVGrgV
iR1QgrGTUkvCk8lnQwGpQGy9YoDOtxmE6q6+oEAq/w9+1gNGbf5zS1E9k0N3Airn
aqokdtm2vd/NrQ0cLQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", "654321", @"
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIy7dd+zj/haoCAggA
MBQGCCqGSIb3DQMHBAiulMnW6wdpQgSCBMg7Urp0XmneldlkQTZgO87/NltdpFwM
SPfApQP5CE3Eiytz+E2pLJiH6mlk51AdbQgdI2q36nW4ZjXLHcI0LIIleBZED/Gj
1/PGLS5c3q4XwFKP8hsl4wASKdpZD+HiAUXGpUTKbt2asVEFTFIMlIYTmJN9e056
+TYAAKq5t/ZCscpJJMF7Sm40139lVTcxqcG8u7fsNqgPv+qbB2b4ANDC46xrdHtm
86xBiAMu7lAxnrnZHBiY+kDYIn1dCVgRICn7Fuggj8khGIQtDmQDOZbwEkFscNHa
uNpp/tKA66KblbZS7NVFkTKsG4q8JUU29yeAIfXegqzUSWxl1HdmlRdbfukNG2UI
aZMNEVh3gJvQPHSOMVPBdOHtnqElraimQNE0nRN8sa71UTVz/bpFord3q7aC2ONR
RP/Y94dsY3qcc5PQ3EaqT0Gz7NePUb08CYWo7wbNSUqXnuja1a0IQpGGUaNefxwJ
FC+b1piHs0O4bwAbSAGFAdD44Hgb55D15n6k4zY/nME6/ve8U3ipBdVQDOFGlFGS
ut0vCUCIdLrzIYP33F5YLSAIlLhn5mEUnycxLMurba/wrz8mXXe0cpYF7alE0JWV
yv7/eIH+KGiDUy9d4jN347vxHtQ4QIJqRS9V58ipfKZvUyGYgw/FCcFj3wvjUlSs
ZmQqj5xtXXKg+1decA8uafhRMkhkD9Ud2zaVfBg0y8lH38j1Hs+bZFS7wZM0CjAl
Fj1M4lYwOJuqkTY75r0YCpbiFN/ZB6kokDVgNqbI8yncj94Lix4Mq4KuLRPEzsLU
I1sHWAruynr0P/jxXFCXmcqfpp7Gtv/9C6vxZ2p7Z5UC9TGnmK8Wv/rlzDaLl5Ke
mcy5gdqsTynW2piYlL/CqD6w5MfehHAUNTjbE+T6zf75k++RmOUPzYp92XE6Kq6s
VaLbiJ/pw29Dd9EjLSRLSEy0OmQwwspuKg6vMMF47LGs+lPAJ3FCGdA3arQ2GVEU
gAGKQECHTnlPPk+cQVrSI6Q5HqiBI+4camewL2kjnhrL/zk7BIGILIQNDvILxivz
omd69aiiONywM8EvSqn+qCOPvNqY1QjMcWA1H/CPsU3N5U8G6K28hcJSc5nP2/I/
jKxmJ222vQfSi8rA3TdncCOOWltGfqrBmEHCF4m3pWzzh3KIE+8TiH35dhX+muq5
1fH3T1oE57r5aCVhQ0zbpvvkAzk2Twdx5FkIITQnsAdQjcIzoyIngBnjhCjDLawv
h1NXbh58oT1dN4AAI7BYJCX02dhjcRFoi2IA4cgmsctOGYfe0PkzV+k1tZDl4v+k
sE8sNcNxuvZ6NMBrjkq5K1eMTdB+BaiuqqGErZqwZq/nNB8bXtDdM85CsuDE39DW
HcFUmQzHcc9Elfwpp9iHX9IXqkaFt1YkAvdmD6clXlk4mHGznzWWUb9trQT+K/6j
ye2bFkKuye/7v4jSsryxP8fh+apjQmrxJlCr6AE1nQySzSsLkJ9EewHF82n08B9F
hbDYz4ACZHf3+1KcVxQnMcOu4jxCjmNnvXi4K+OhyNHzYP95vgOAV4Cz2IJbrHz4
YOlAEg2KkdDs9uG9h+uTTy7YWVOP6W7Qa7z2PCdZYmVgCLgjJxdUA3VgFnGMqicy
md0=
-----END ENCRYPTED PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtjnFC7d0YZHM/CF7winn
Lhy8KRThFsZTnr0PhUSaZ2oWLbChYY+20sb1TaZr+oEyuX05ntSkLs5U7yzLdbfL
aV9TnIlQlMtN98x+zfbBv4g+lj9IqYDto/ZfgLronSiJ0sNNrKH9o8mq6090QLph
32YId28YpkDmr2hqtKcNE+ZzNlCM/iNOiL9udR7bwAZMrn0ZAnOohgOj87AAJG++
onkDRRIBASgOVAzZOxR2KcZCYqFa8ti9PHayCm3bfqAR0kHcelN9uZa/vBJbE7wv
Sh023d7INLz09UqK/NAU+km3XUmOOxBlz9h3DkxriMTZJq06IQRuAeLcxRs53KlE
mwIDAQAB
-----END PUBLIC KEY-----
")]
    public void UpdatePrivateKeyPasswordTest(string oldPassword, string newPassword, string privateKey, string expected)
    {
        var updatedKey = _rsaKey.UpdatePrivateKeyPassword(privateKey, oldPassword, newPassword);
        var publicKey = _rsaKey.ExportPublicKey(updatedKey, newPassword);
        Assert.AreEqual(expected.Trim(), publicKey.Trim());
    }

    [TestMethod]
    [DataRow(RsaKeyType.Pkcs1, @"
<RSAKeyValue>
  <DP>DEqhG4Q1WwSQP5nPI9vs0xzuZIxZcTyj1rRTT6zLCYGd1E1KELpVj7SlqtiiGg8z35VW9TLu+qJGx4dxH/BYEkoK0hzdMUOoqrEc2yrQOU6DCEQNntdWOap72IOtiogGZfI8AHALTkhhhDou4w4MGA4/Ub0hbaL+mFvfWFduUM8=</DP>
  <DQ>Nw1w+JCAY2lJDAtr/eCbMXuK3GmJE2zEhLmkNuL7NTHVIGRleaqktQd0ymJ6ToZwb7LTWCUuFtuhgRAzXX+QG0Q8dwHRuqwgQGRgRhI0cVrZx7tkUY8O2rCJgORDfIncTC6ehvaDWhVMhV17e9WSr5MSWwNJW9vDvH+IMoBYJbc=</DQ>
  <D>EyXZWr7MrS0qg3WW9ba6hEp9fVaSf16U2xHuteOB9yw9WdCtBXf4jjwUprkxICyLm8tCrlg2XQxC1jaJZtRqneuecefO+Jpg5q7j7xoM0phKPiM+QMxnTsJOexXjpr+A+b+s5vNDPthexKNKINDrqfmtAmBites4bm2/J/W2Ds4sgzlqXh8/GOH4xd7G14C+7VWGO9q10E9J9zk62M6OhhBxtCbJHiXcKK22m8HAgBjKCwyrYFgR+LgSWIrAhH99YDskUoZEOZT79p5EVffM/eXLqVVVEUcZDMY10b7cTxu6sQCXKLijkv0z3bE/ZGAAW1llOnWLSJCdm0uzG/g3SQ==</D>
  <Modulus>zYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQ==</Modulus>
  <Exponent>AQAB</Exponent>
  <InverseQ>FueFtUS6JpCW31IUgablpGCecG/DUiZVZXn+g+FkzGd7QQ4l5f2orss/Dmkzr8/4uDgB61nuSe6tZR1huZCSbtUwNgTe08trkJ+EQlF9ZpHuHEGqp3I4VqwiO3uWKaI2qqKQOXKNK+WOhMMmtpEypIXFwmzjx18VSNhm6V9CFRk=</InverseQ>
  <P>0L7h02AMr4avRutq+1xSdhDzKYLAno3nJVwDLyxtenARYBDf07ZiLvs/lb7rJjsrXwLBeoUWMdZM8I7NvaBXNfDQ1/odumav8+lqOfU2eMjlLz0XFCn/I0XSbOVm56AA7USoJWr8o2/mTRC5kHsRUjdI568DCT/EQKUHxpo2z7s=</P>
  <Q>/AqorP52EHJj2TzAFx2wBvzXPjklYB7CIejgMep4W6cgI+/d6l0AAxQv44RCePDDQLTkB6nXnr7SWzMi2WgOW3YmgdaPQRxTasrqkN0VQWMBLD8X5CmRefir2UKxmI0UJ8DQHmuXgBwowAgG5AgOirLnVyOcxJgASnQA9189iaM=</Q>
</RSAKeyValue>
", @"
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAzYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5
IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRz
Nt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o
3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEq
hERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3
Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQIDAQABAoIBABMl2Vq+zK0tKoN1
lvW2uoRKfX1Wkn9elNsR7rXjgfcsPVnQrQV3+I48FKa5MSAsi5vLQq5YNl0MQtY2
iWbUap3rnnHnzviaYOau4+8aDNKYSj4jPkDMZ07CTnsV46a/gPm/rObzQz7YXsSj
SiDQ66n5rQJgYrXrOG5tvyf1tg7OLIM5al4fPxjh+MXexteAvu1VhjvatdBPSfc5
OtjOjoYQcbQmyR4l3CittpvBwIAYygsMq2BYEfi4EliKwIR/fWA7JFKGRDmU+/ae
RFX3zP3ly6lVVRFHGQzGNdG+3E8burEAlyi4o5L9M92xP2RgAFtZZTp1i0iQnZtL
sxv4N0kCgYEA0L7h02AMr4avRutq+1xSdhDzKYLAno3nJVwDLyxtenARYBDf07Zi
Lvs/lb7rJjsrXwLBeoUWMdZM8I7NvaBXNfDQ1/odumav8+lqOfU2eMjlLz0XFCn/
I0XSbOVm56AA7USoJWr8o2/mTRC5kHsRUjdI568DCT/EQKUHxpo2z7sCgYEA/Aqo
rP52EHJj2TzAFx2wBvzXPjklYB7CIejgMep4W6cgI+/d6l0AAxQv44RCePDDQLTk
B6nXnr7SWzMi2WgOW3YmgdaPQRxTasrqkN0VQWMBLD8X5CmRefir2UKxmI0UJ8DQ
HmuXgBwowAgG5AgOirLnVyOcxJgASnQA9189iaMCgYAMSqEbhDVbBJA/mc8j2+zT
HO5kjFlxPKPWtFNPrMsJgZ3UTUoQulWPtKWq2KIaDzPflVb1Mu76okbHh3Ef8FgS
SgrSHN0xQ6iqsRzbKtA5ToMIRA2e11Y5qnvYg62KiAZl8jwAcAtOSGGEOi7jDgwY
Dj9RvSFtov6YW99YV25QzwKBgDcNcPiQgGNpSQwLa/3gmzF7itxpiRNsxIS5pDbi
+zUx1SBkZXmqpLUHdMpiek6GcG+y01glLhbboYEQM11/kBtEPHcB0bqsIEBkYEYS
NHFa2ce7ZFGPDtqwiYDkQ3yJ3Ewunob2g1oVTIVde3vVkq+TElsDSVvbw7x/iDKA
WCW3AoGAFueFtUS6JpCW31IUgablpGCecG/DUiZVZXn+g+FkzGd7QQ4l5f2orss/
Dmkzr8/4uDgB61nuSe6tZR1huZCSbtUwNgTe08trkJ+EQlF9ZpHuHEGqp3I4Vqwi
O3uWKaI2qqKQOXKNK+WOhMMmtpEypIXFwmzjx18VSNhm6V9CFRk=
-----END RSA PRIVATE KEY-----
")]
    [DataRow(RsaKeyType.Pkcs8, @"
<RSAKeyValue>
  <DP>DEqhG4Q1WwSQP5nPI9vs0xzuZIxZcTyj1rRTT6zLCYGd1E1KELpVj7SlqtiiGg8z35VW9TLu+qJGx4dxH/BYEkoK0hzdMUOoqrEc2yrQOU6DCEQNntdWOap72IOtiogGZfI8AHALTkhhhDou4w4MGA4/Ub0hbaL+mFvfWFduUM8=</DP>
  <DQ>Nw1w+JCAY2lJDAtr/eCbMXuK3GmJE2zEhLmkNuL7NTHVIGRleaqktQd0ymJ6ToZwb7LTWCUuFtuhgRAzXX+QG0Q8dwHRuqwgQGRgRhI0cVrZx7tkUY8O2rCJgORDfIncTC6ehvaDWhVMhV17e9WSr5MSWwNJW9vDvH+IMoBYJbc=</DQ>
  <D>EyXZWr7MrS0qg3WW9ba6hEp9fVaSf16U2xHuteOB9yw9WdCtBXf4jjwUprkxICyLm8tCrlg2XQxC1jaJZtRqneuecefO+Jpg5q7j7xoM0phKPiM+QMxnTsJOexXjpr+A+b+s5vNDPthexKNKINDrqfmtAmBites4bm2/J/W2Ds4sgzlqXh8/GOH4xd7G14C+7VWGO9q10E9J9zk62M6OhhBxtCbJHiXcKK22m8HAgBjKCwyrYFgR+LgSWIrAhH99YDskUoZEOZT79p5EVffM/eXLqVVVEUcZDMY10b7cTxu6sQCXKLijkv0z3bE/ZGAAW1llOnWLSJCdm0uzG/g3SQ==</D>
  <Modulus>zYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQ==</Modulus>
  <Exponent>AQAB</Exponent>
  <InverseQ>FueFtUS6JpCW31IUgablpGCecG/DUiZVZXn+g+FkzGd7QQ4l5f2orss/Dmkzr8/4uDgB61nuSe6tZR1huZCSbtUwNgTe08trkJ+EQlF9ZpHuHEGqp3I4VqwiO3uWKaI2qqKQOXKNK+WOhMMmtpEypIXFwmzjx18VSNhm6V9CFRk=</InverseQ>
  <P>0L7h02AMr4avRutq+1xSdhDzKYLAno3nJVwDLyxtenARYBDf07ZiLvs/lb7rJjsrXwLBeoUWMdZM8I7NvaBXNfDQ1/odumav8+lqOfU2eMjlLz0XFCn/I0XSbOVm56AA7USoJWr8o2/mTRC5kHsRUjdI568DCT/EQKUHxpo2z7s=</P>
  <Q>/AqorP52EHJj2TzAFx2wBvzXPjklYB7CIejgMep4W6cgI+/d6l0AAxQv44RCePDDQLTkB6nXnr7SWzMi2WgOW3YmgdaPQRxTasrqkN0VQWMBLD8X5CmRefir2UKxmI0UJ8DQHmuXgBwowAgG5AgOirLnVyOcxJgASnQA9189iaM=</Q>
</RSAKeyValue>
", @"
-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDNhJdLOL5XyVDG
kNRznmfvcIUmUqvPaT5fCYzHqR+OjpH9EPkhVLEFJELdHGtjRFSJeEN7+HumjmAy
tEP6NOMrRwm09o+9T3iKLeSUgEpR4trJpHM23eBvwitTcr2IOVfYcv0B731HgnUZ
flAquYAp0H9KGYlcvMPygd6H4GN4WCOMfmjfCiNXydMXIJ7bQryzasu+SS2BsQEb
Q492C3UvDEaQe+NYWdK+QuscdCbr7F2ioSqERFz717sjgXJbqXuWyJWr469zopXy
OT629z6lGVIkGMQcu49nNttpRvT7BjtfVDclz28/9CuoBIEodIAQPzH8wBOHRAFo
v45qoFcRAgMBAAECggEAEyXZWr7MrS0qg3WW9ba6hEp9fVaSf16U2xHuteOB9yw9
WdCtBXf4jjwUprkxICyLm8tCrlg2XQxC1jaJZtRqneuecefO+Jpg5q7j7xoM0phK
PiM+QMxnTsJOexXjpr+A+b+s5vNDPthexKNKINDrqfmtAmBites4bm2/J/W2Ds4s
gzlqXh8/GOH4xd7G14C+7VWGO9q10E9J9zk62M6OhhBxtCbJHiXcKK22m8HAgBjK
CwyrYFgR+LgSWIrAhH99YDskUoZEOZT79p5EVffM/eXLqVVVEUcZDMY10b7cTxu6
sQCXKLijkv0z3bE/ZGAAW1llOnWLSJCdm0uzG/g3SQKBgQDQvuHTYAyvhq9G62r7
XFJ2EPMpgsCejeclXAMvLG16cBFgEN/TtmIu+z+VvusmOytfAsF6hRYx1kzwjs29
oFc18NDX+h26Zq/z6Wo59TZ4yOUvPRcUKf8jRdJs5WbnoADtRKglavyjb+ZNELmQ
exFSN0jnrwMJP8RApQfGmjbPuwKBgQD8Cqis/nYQcmPZPMAXHbAG/Nc+OSVgHsIh
6OAx6nhbpyAj793qXQADFC/jhEJ48MNAtOQHqdeevtJbMyLZaA5bdiaB1o9BHFNq
yuqQ3RVBYwEsPxfkKZF5+KvZQrGYjRQnwNAea5eAHCjACAbkCA6KsudXI5zEmABK
dAD3Xz2JowKBgAxKoRuENVsEkD+ZzyPb7NMc7mSMWXE8o9a0U0+sywmBndRNShC6
VY+0parYohoPM9+VVvUy7vqiRseHcR/wWBJKCtIc3TFDqKqxHNsq0DlOgwhEDZ7X
Vjmqe9iDrYqIBmXyPABwC05IYYQ6LuMODBgOP1G9IW2i/phb31hXblDPAoGANw1w
+JCAY2lJDAtr/eCbMXuK3GmJE2zEhLmkNuL7NTHVIGRleaqktQd0ymJ6ToZwb7LT
WCUuFtuhgRAzXX+QG0Q8dwHRuqwgQGRgRhI0cVrZx7tkUY8O2rCJgORDfIncTC6e
hvaDWhVMhV17e9WSr5MSWwNJW9vDvH+IMoBYJbcCgYAW54W1RLomkJbfUhSBpuWk
YJ5wb8NSJlVlef6D4WTMZ3tBDiXl/aiuyz8OaTOvz/i4OAHrWe5J7q1lHWG5kJJu
1TA2BN7Ty2uQn4RCUX1mke4cQaqncjhWrCI7e5YpojaqopA5co0r5Y6Ewya2kTKk
hcXCbOPHXxVI2GbpX0IVGQ==
-----END PRIVATE KEY-----
")]
    [DataRow(RsaKeyType.PemPublic, @"
<RSAKeyValue>
  <Modulus>zYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQ==</Modulus>
  <Exponent>AQAB</Exponent>
</RSAKeyValue>
", @"
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzYSXSzi+V8lQxpDUc55n
73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTj
K0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmA
KdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1
LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+
pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBX
EQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow(RsaKeyType.Xml, @"
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQCWfwDJIpSxL9MDtHn/CBr0tJe0dKqog4Xn3/qd6Y1e4GJkOx4b
m7u4eQm7tPUXdNopJiBrs10D7Tsiqube6Xd/KQqWf/GbkjGPaUvI3L7G9C621pwX
ck4caLkU6iKGoflS14dwaI0Ry6V/vwaddZ+PBtj65WROtTbGGnffLsQD1wIDAQAB
AoGASLz2qMBFhMQ8JZjHtBt7R9W3UxlmWI9FG7bWPxegZABondAy854YI4egzDAg
m6c3QFc0qUlmRh0VjWJztr65qaDckM/I7XGgi//UQJPRZbJGGIac/glDx3USaiRL
yo/1wJnZKWzy30L9vSA3KKlC0kc7+EOlxppdDqTpXnaaJykCQQCYc3VHF3vSJRWu
THin7YZloufEUo8yoqEdsFN3IT9GS0l7mnBs1qtT5qnKxbEC8bSlUWCC/rqiDYjP
WdNvjkC/AkEA/LefM2YaBhATMyEoQbNCiiCBoOGOgIdvLfCwneqrrWsOjhJ7WXDJ
5rLWT2IpYvW4tgpr8cpi/OsSrXJF44Rq6QJASnkEjpETRMom+DmVK3umDtpw2//0
wiieClHLxENylJVMtVvxlcmccmUZBtxiJ20J8UR6oCNt6qIv9hMMbc+RIwJAXpMh
Qwz8xDQT21iXRi8dwa90k46V08fbdafTkOWXpeigo86K1uf8xxc6WK71qhEnNQkl
aHFDJj+a18oiGYkesQJAFDL56rQSD7Btj7L5bqHX3uFPyDiGA8DxFVDcLLv7xLrO
0LjAroGuA7XFAqFxAzMl+0OSidVrvrLgA9tpZ4g1vw==
-----END RSA PRIVATE KEY-----
", @"
<RSAKeyValue><Modulus>ln8AySKUsS/TA7R5/wga9LSXtHSqqIOF59/6nemNXuBiZDseG5u7uHkJu7T1F3TaKSYga7NdA+07Iqrm3ul3fykKln/xm5Ixj2lLyNy+xvQuttacF3JOHGi5FOoihqH5UteHcGiNEculf78GnXWfjwbY+uVkTrU2xhp33y7EA9c=</Modulus><Exponent>AQAB</Exponent><P>mHN1Rxd70iUVrkx4p+2GZaLnxFKPMqKhHbBTdyE/RktJe5pwbNarU+apysWxAvG0pVFggv66og2Iz1nTb45Avw==</P><Q>/LefM2YaBhATMyEoQbNCiiCBoOGOgIdvLfCwneqrrWsOjhJ7WXDJ5rLWT2IpYvW4tgpr8cpi/OsSrXJF44Rq6Q==</Q><DP>SnkEjpETRMom+DmVK3umDtpw2//0wiieClHLxENylJVMtVvxlcmccmUZBtxiJ20J8UR6oCNt6qIv9hMMbc+RIw==</DP><DQ>XpMhQwz8xDQT21iXRi8dwa90k46V08fbdafTkOWXpeigo86K1uf8xxc6WK71qhEnNQklaHFDJj+a18oiGYkesQ==</DQ><InverseQ>FDL56rQSD7Btj7L5bqHX3uFPyDiGA8DxFVDcLLv7xLrO0LjAroGuA7XFAqFxAzMl+0OSidVrvrLgA9tpZ4g1vw==</InverseQ><D>SLz2qMBFhMQ8JZjHtBt7R9W3UxlmWI9FG7bWPxegZABondAy854YI4egzDAgm6c3QFc0qUlmRh0VjWJztr65qaDckM/I7XGgi//UQJPRZbJGGIac/glDx3USaiRLyo/1wJnZKWzy30L9vSA3KKlC0kc7+EOlxppdDqTpXnaaJyk=</D></RSAKeyValue>
")]
    [DataRow(RsaKeyType.Pkcs8, @"
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQCWfwDJIpSxL9MDtHn/CBr0tJe0dKqog4Xn3/qd6Y1e4GJkOx4b
m7u4eQm7tPUXdNopJiBrs10D7Tsiqube6Xd/KQqWf/GbkjGPaUvI3L7G9C621pwX
ck4caLkU6iKGoflS14dwaI0Ry6V/vwaddZ+PBtj65WROtTbGGnffLsQD1wIDAQAB
AoGASLz2qMBFhMQ8JZjHtBt7R9W3UxlmWI9FG7bWPxegZABondAy854YI4egzDAg
m6c3QFc0qUlmRh0VjWJztr65qaDckM/I7XGgi//UQJPRZbJGGIac/glDx3USaiRL
yo/1wJnZKWzy30L9vSA3KKlC0kc7+EOlxppdDqTpXnaaJykCQQCYc3VHF3vSJRWu
THin7YZloufEUo8yoqEdsFN3IT9GS0l7mnBs1qtT5qnKxbEC8bSlUWCC/rqiDYjP
WdNvjkC/AkEA/LefM2YaBhATMyEoQbNCiiCBoOGOgIdvLfCwneqrrWsOjhJ7WXDJ
5rLWT2IpYvW4tgpr8cpi/OsSrXJF44Rq6QJASnkEjpETRMom+DmVK3umDtpw2//0
wiieClHLxENylJVMtVvxlcmccmUZBtxiJ20J8UR6oCNt6qIv9hMMbc+RIwJAXpMh
Qwz8xDQT21iXRi8dwa90k46V08fbdafTkOWXpeigo86K1uf8xxc6WK71qhEnNQkl
aHFDJj+a18oiGYkesQJAFDL56rQSD7Btj7L5bqHX3uFPyDiGA8DxFVDcLLv7xLrO
0LjAroGuA7XFAqFxAzMl+0OSidVrvrLgA9tpZ4g1vw==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PRIVATE KEY-----
MIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAJZ/AMkilLEv0wO0
ef8IGvS0l7R0qqiDheff+p3pjV7gYmQ7Hhubu7h5Cbu09Rd02ikmIGuzXQPtOyKq
5t7pd38pCpZ/8ZuSMY9pS8jcvsb0LrbWnBdyThxouRTqIoah+VLXh3BojRHLpX+/
Bp11n48G2PrlZE61NsYad98uxAPXAgMBAAECgYBIvPaowEWExDwlmMe0G3tH1bdT
GWZYj0UbttY/F6BkAGid0DLznhgjh6DMMCCbpzdAVzSpSWZGHRWNYnO2vrmpoNyQ
z8jtcaCL/9RAk9FlskYYhpz+CUPHdRJqJEvKj/XAmdkpbPLfQv29IDcoqULSRzv4
Q6XGml0OpOledponKQJBAJhzdUcXe9IlFa5MeKfthmWi58RSjzKioR2wU3chP0ZL
SXuacGzWq1PmqcrFsQLxtKVRYIL+uqINiM9Z02+OQL8CQQD8t58zZhoGEBMzIShB
s0KKIIGg4Y6Ah28t8LCd6qutaw6OEntZcMnmstZPYili9bi2CmvxymL86xKtckXj
hGrpAkBKeQSOkRNEyib4OZUre6YO2nDb//TCKJ4KUcvEQ3KUlUy1W/GVyZxyZRkG
3GInbQnxRHqgI23qoi/2Ewxtz5EjAkBekyFDDPzENBPbWJdGLx3Br3STjpXTx9t1
p9OQ5Zel6KCjzorW5/zHFzpYrvWqESc1CSVocUMmP5rXyiIZiR6xAkAUMvnqtBIP
sG2Psvluodfe4U/IOIYDwPEVUNwsu/vEus7QuMCuga4DtcUCoXEDMyX7Q5KJ1Wu+
suAD22lniDW/
-----END PRIVATE KEY-----
")]
    [DataRow(RsaKeyType.Xml, @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCWfwDJIpSxL9MDtHn/CBr0tJe0
dKqog4Xn3/qd6Y1e4GJkOx4bm7u4eQm7tPUXdNopJiBrs10D7Tsiqube6Xd/KQqW
f/GbkjGPaUvI3L7G9C621pwXck4caLkU6iKGoflS14dwaI0Ry6V/vwaddZ+PBtj6
5WROtTbGGnffLsQD1wIDAQAB
-----END PUBLIC KEY-----
", @"
<RSAKeyValue><Modulus>ln8AySKUsS/TA7R5/wga9LSXtHSqqIOF59/6nemNXuBiZDseG5u7uHkJu7T1F3TaKSYga7NdA+07Iqrm3ul3fykKln/xm5Ixj2lLyNy+xvQuttacF3JOHGi5FOoihqH5UteHcGiNEculf78GnXWfjwbY+uVkTrU2xhp33y7EA9c=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>
")]
    [DataRow(RsaKeyType.Xml, @"
-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDVHo+BkTqDo8tc
6qhD56/MoRK81SmTcUC8uiC10WktxlIBXsOZ7RSqg1D/bA73274qzEmAZZPtYR/X
7mKzjEgbwffAkYQc2/ac+JNIdxJOhB3vUkJUfb5r4JlD1ARhFpRYsNl/qrgxLMf6
H1KsS0MMXICCG2lC0utfO4X9zl2vV+YF24ZOSKrUnXsPONYIRGdHWWdcIqr6l+x/
ULbBl1BvdhE7WBQ8LOAS6zIevnws19gPLg1GHHXN56kN/aelevjPlXFvKho6GMSG
9ZUGCRMxB/9GylR1w8sT4M4aHr+/hNK9x/B/AkFS29upMjkHt3R2SfJqjHaPCELW
JWIIe9z1AgMBAAECggEBALbumoO+4xknuWGyUminMLFW+Tx5REy5A7Z7laQ7cirG
dpGShBdV9009loMIf/ik+CDIZbb+efFiUvEIQFSZ7zNUVZNH1Lzo2lB21gV3n5Eh
uog4dZMMtCzpBuW/0Vp9BSzz8F2zbpNXOvgpds9Jcu3jYLNNUBb58Os3rpXjU2sz
WHzSzla7/b0fBjMIWepgpl5SemwN7J2l+GhjOg6cjwkCIp/94GuRlZ+28l1HlPJt
wiMvCbJx53SCUFSmZee8p8BMoNpbzg2sFgpGbQmcNTWkm1R2DYhkeMEF3cZvJOoD
eFECupiHJ2ZfodRZgIySHJIIqbo2rG6qjeOVH+zbaekCgYEA81McX3gwYPER6LhX
a2vWcY95K9cCMRKsW/V6w4csIypfB1icTy34Y63Q5VvOvEHR35+/GKNpSfJK5m45
AC7677njeLbYEPHcb/JF8Qu4iCjazDS1Cp+g8FwOxUHyWJGXojlrza2EyPQPZwea
9dIALZNfFjMGZQUCBDFGRlJXKvcCgYEA4DikptfLnWQHVoO0CnDERpl7XY635WNt
BnBHuhSEU3ryokzRs+IimuEZmUJZhvOFXykU/duYfGeoyej6WdW+3bF1NEa2K39T
rV/GyfoJMS6PCXi5dBx7caIxOWsM7HUlBF9I0K4TuCWue7Gx0Ry1/QbFosgurBiT
73ysohZU8HMCgYEAvBnIukjoZViW9qfi9Kj1qu41xt081YDQ+3nmgFbzmO+9bKlk
lJU+Cpio/1WcmM3tF4mfqcVRtJd4rXAR4oFu/XlfTsdSeq7uMSBCT1g3PBMRKYGp
XuAOAyG3TWhwl2VdqkvneaWlG9AIRCaN9XB1MMZXYIrra5aWe3U4FU68EfsCgYEA
29zPH0cFQt0eEOhuN7qhy/SeMnxKuKUI+EJLIx0RMGaj2x/mlTQN6L8Hge+8qAbM
ZiZ7jf2xhXOD4BESw9pDIVHscolQAlEFNUFwRQdn0hEscwYtG7z+EswO5pWhA5BO
7v2cAfxgG7bfZC03BqzXizgDvf37PgePsEsZYIrzWR8CgYAm0pf+Zc/aChi4FleY
CXqsVQVb6deKtMjnRaZLogQdLk6dXV0qLax17e8ePJHiDww3oLFZk3KZ72uXzWeM
/seA71Is1CIWpBcuRXyWm8Yf0ByqWH1yCSEUFLKuaocIssINtz9rwobZb8yOawXM
hdLCEri6FzMt3fbfIAjvMiZE8A==
-----END PRIVATE KEY-----
", @"
<RSAKeyValue><Modulus>1R6PgZE6g6PLXOqoQ+evzKESvNUpk3FAvLogtdFpLcZSAV7Dme0UqoNQ/2wO99u+KsxJgGWT7WEf1+5is4xIG8H3wJGEHNv2nPiTSHcSToQd71JCVH2+a+CZQ9QEYRaUWLDZf6q4MSzH+h9SrEtDDFyAghtpQtLrXzuF/c5dr1fmBduGTkiq1J17DzjWCERnR1lnXCKq+pfsf1C2wZdQb3YRO1gUPCzgEusyHr58LNfYDy4NRhx1zeepDf2npXr4z5VxbyoaOhjEhvWVBgkTMQf/RspUdcPLE+DOGh6/v4TSvcfwfwJBUtvbqTI5B7d0dknyaox2jwhC1iViCHvc9Q==</Modulus><Exponent>AQAB</Exponent><P>81McX3gwYPER6LhXa2vWcY95K9cCMRKsW/V6w4csIypfB1icTy34Y63Q5VvOvEHR35+/GKNpSfJK5m45AC7677njeLbYEPHcb/JF8Qu4iCjazDS1Cp+g8FwOxUHyWJGXojlrza2EyPQPZwea9dIALZNfFjMGZQUCBDFGRlJXKvc=</P><Q>4DikptfLnWQHVoO0CnDERpl7XY635WNtBnBHuhSEU3ryokzRs+IimuEZmUJZhvOFXykU/duYfGeoyej6WdW+3bF1NEa2K39TrV/GyfoJMS6PCXi5dBx7caIxOWsM7HUlBF9I0K4TuCWue7Gx0Ry1/QbFosgurBiT73ysohZU8HM=</Q><DP>vBnIukjoZViW9qfi9Kj1qu41xt081YDQ+3nmgFbzmO+9bKlklJU+Cpio/1WcmM3tF4mfqcVRtJd4rXAR4oFu/XlfTsdSeq7uMSBCT1g3PBMRKYGpXuAOAyG3TWhwl2VdqkvneaWlG9AIRCaN9XB1MMZXYIrra5aWe3U4FU68Efs=</DP><DQ>29zPH0cFQt0eEOhuN7qhy/SeMnxKuKUI+EJLIx0RMGaj2x/mlTQN6L8Hge+8qAbMZiZ7jf2xhXOD4BESw9pDIVHscolQAlEFNUFwRQdn0hEscwYtG7z+EswO5pWhA5BO7v2cAfxgG7bfZC03BqzXizgDvf37PgePsEsZYIrzWR8=</DQ><InverseQ>JtKX/mXP2goYuBZXmAl6rFUFW+nXirTI50WmS6IEHS5OnV1dKi2sde3vHjyR4g8MN6CxWZNyme9rl81njP7HgO9SLNQiFqQXLkV8lpvGH9Acqlh9cgkhFBSyrmqHCLLCDbc/a8KG2W/MjmsFzIXSwhK4uhczLd323yAI7zImRPA=</InverseQ><D>tu6ag77jGSe5YbJSaKcwsVb5PHlETLkDtnuVpDtyKsZ2kZKEF1X3TT2Wgwh/+KT4IMhltv558WJS8QhAVJnvM1RVk0fUvOjaUHbWBXefkSG6iDh1kwy0LOkG5b/RWn0FLPPwXbNuk1c6+Cl2z0ly7eNgs01QFvnw6zeuleNTazNYfNLOVrv9vR8GMwhZ6mCmXlJ6bA3snaX4aGM6DpyPCQIin/3ga5GVn7byXUeU8m3CIy8JsnHndIJQVKZl57ynwEyg2lvODawWCkZtCZw1NaSbVHYNiGR4wQXdxm8k6gN4UQK6mIcnZl+h1FmAjJIckgipujasbqqN45Uf7Ntp6Q==</D></RSAKeyValue>
")]
    [DataRow(RsaKeyType.Pkcs1, @"
-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDVHo+BkTqDo8tc
6qhD56/MoRK81SmTcUC8uiC10WktxlIBXsOZ7RSqg1D/bA73274qzEmAZZPtYR/X
7mKzjEgbwffAkYQc2/ac+JNIdxJOhB3vUkJUfb5r4JlD1ARhFpRYsNl/qrgxLMf6
H1KsS0MMXICCG2lC0utfO4X9zl2vV+YF24ZOSKrUnXsPONYIRGdHWWdcIqr6l+x/
ULbBl1BvdhE7WBQ8LOAS6zIevnws19gPLg1GHHXN56kN/aelevjPlXFvKho6GMSG
9ZUGCRMxB/9GylR1w8sT4M4aHr+/hNK9x/B/AkFS29upMjkHt3R2SfJqjHaPCELW
JWIIe9z1AgMBAAECggEBALbumoO+4xknuWGyUminMLFW+Tx5REy5A7Z7laQ7cirG
dpGShBdV9009loMIf/ik+CDIZbb+efFiUvEIQFSZ7zNUVZNH1Lzo2lB21gV3n5Eh
uog4dZMMtCzpBuW/0Vp9BSzz8F2zbpNXOvgpds9Jcu3jYLNNUBb58Os3rpXjU2sz
WHzSzla7/b0fBjMIWepgpl5SemwN7J2l+GhjOg6cjwkCIp/94GuRlZ+28l1HlPJt
wiMvCbJx53SCUFSmZee8p8BMoNpbzg2sFgpGbQmcNTWkm1R2DYhkeMEF3cZvJOoD
eFECupiHJ2ZfodRZgIySHJIIqbo2rG6qjeOVH+zbaekCgYEA81McX3gwYPER6LhX
a2vWcY95K9cCMRKsW/V6w4csIypfB1icTy34Y63Q5VvOvEHR35+/GKNpSfJK5m45
AC7677njeLbYEPHcb/JF8Qu4iCjazDS1Cp+g8FwOxUHyWJGXojlrza2EyPQPZwea
9dIALZNfFjMGZQUCBDFGRlJXKvcCgYEA4DikptfLnWQHVoO0CnDERpl7XY635WNt
BnBHuhSEU3ryokzRs+IimuEZmUJZhvOFXykU/duYfGeoyej6WdW+3bF1NEa2K39T
rV/GyfoJMS6PCXi5dBx7caIxOWsM7HUlBF9I0K4TuCWue7Gx0Ry1/QbFosgurBiT
73ysohZU8HMCgYEAvBnIukjoZViW9qfi9Kj1qu41xt081YDQ+3nmgFbzmO+9bKlk
lJU+Cpio/1WcmM3tF4mfqcVRtJd4rXAR4oFu/XlfTsdSeq7uMSBCT1g3PBMRKYGp
XuAOAyG3TWhwl2VdqkvneaWlG9AIRCaN9XB1MMZXYIrra5aWe3U4FU68EfsCgYEA
29zPH0cFQt0eEOhuN7qhy/SeMnxKuKUI+EJLIx0RMGaj2x/mlTQN6L8Hge+8qAbM
ZiZ7jf2xhXOD4BESw9pDIVHscolQAlEFNUFwRQdn0hEscwYtG7z+EswO5pWhA5BO
7v2cAfxgG7bfZC03BqzXizgDvf37PgePsEsZYIrzWR8CgYAm0pf+Zc/aChi4FleY
CXqsVQVb6deKtMjnRaZLogQdLk6dXV0qLax17e8ePJHiDww3oLFZk3KZ72uXzWeM
/seA71Is1CIWpBcuRXyWm8Yf0ByqWH1yCSEUFLKuaocIssINtz9rwobZb8yOawXM
hdLCEri6FzMt3fbfIAjvMiZE8A==
-----END PRIVATE KEY-----
", @"
-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA1R6PgZE6g6PLXOqoQ+evzKESvNUpk3FAvLogtdFpLcZSAV7D
me0UqoNQ/2wO99u+KsxJgGWT7WEf1+5is4xIG8H3wJGEHNv2nPiTSHcSToQd71JC
VH2+a+CZQ9QEYRaUWLDZf6q4MSzH+h9SrEtDDFyAghtpQtLrXzuF/c5dr1fmBduG
Tkiq1J17DzjWCERnR1lnXCKq+pfsf1C2wZdQb3YRO1gUPCzgEusyHr58LNfYDy4N
Rhx1zeepDf2npXr4z5VxbyoaOhjEhvWVBgkTMQf/RspUdcPLE+DOGh6/v4TSvcfw
fwJBUtvbqTI5B7d0dknyaox2jwhC1iViCHvc9QIDAQABAoIBAQC27pqDvuMZJ7lh
slJopzCxVvk8eURMuQO2e5WkO3IqxnaRkoQXVfdNPZaDCH/4pPggyGW2/nnxYlLx
CEBUme8zVFWTR9S86NpQdtYFd5+RIbqIOHWTDLQs6Qblv9FafQUs8/Bds26TVzr4
KXbPSXLt42CzTVAW+fDrN66V41NrM1h80s5Wu/29HwYzCFnqYKZeUnpsDeydpfho
YzoOnI8JAiKf/eBrkZWftvJdR5TybcIjLwmyced0glBUpmXnvKfATKDaW84NrBYK
Rm0JnDU1pJtUdg2IZHjBBd3GbyTqA3hRArqYhydmX6HUWYCMkhySCKm6Nqxuqo3j
lR/s22npAoGBAPNTHF94MGDxEei4V2tr1nGPeSvXAjESrFv1esOHLCMqXwdYnE8t
+GOt0OVbzrxB0d+fvxijaUnySuZuOQAu+u+543i22BDx3G/yRfELuIgo2sw0tQqf
oPBcDsVB8liRl6I5a82thMj0D2cHmvXSAC2TXxYzBmUFAgQxRkZSVyr3AoGBAOA4
pKbXy51kB1aDtApwxEaZe12Ot+VjbQZwR7oUhFN68qJM0bPiIprhGZlCWYbzhV8p
FP3bmHxnqMno+lnVvt2xdTRGtit/U61fxsn6CTEujwl4uXQce3GiMTlrDOx1JQRf
SNCuE7glrnuxsdEctf0GxaLILqwYk+98rKIWVPBzAoGBALwZyLpI6GVYlvan4vSo
9aruNcbdPNWA0Pt55oBW85jvvWypZJSVPgqYqP9VnJjN7ReJn6nFUbSXeK1wEeKB
bv15X07HUnqu7jEgQk9YNzwTESmBqV7gDgMht01ocJdlXapL53mlpRvQCEQmjfVw
dTDGV2CK62uWlnt1OBVOvBH7AoGBANvczx9HBULdHhDobje6ocv0njJ8SrilCPhC
SyMdETBmo9sf5pU0Dei/B4HvvKgGzGYme439sYVzg+AREsPaQyFR7HKJUAJRBTVB
cEUHZ9IRLHMGLRu8/hLMDuaVoQOQTu79nAH8YBu232QtNwas14s4A739+z4Hj7BL
GWCK81kfAoGAJtKX/mXP2goYuBZXmAl6rFUFW+nXirTI50WmS6IEHS5OnV1dKi2s
de3vHjyR4g8MN6CxWZNyme9rl81njP7HgO9SLNQiFqQXLkV8lpvGH9Acqlh9cgkh
FBSyrmqHCLLCDbc/a8KG2W/MjmsFzIXSwhK4uhczLd323yAI7zImRPA=
-----END RSA PRIVATE KEY-----
")]
    [DataRow(RsaKeyType.Xml, @"
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1R6PgZE6g6PLXOqoQ+ev
zKESvNUpk3FAvLogtdFpLcZSAV7Dme0UqoNQ/2wO99u+KsxJgGWT7WEf1+5is4xI
G8H3wJGEHNv2nPiTSHcSToQd71JCVH2+a+CZQ9QEYRaUWLDZf6q4MSzH+h9SrEtD
DFyAghtpQtLrXzuF/c5dr1fmBduGTkiq1J17DzjWCERnR1lnXCKq+pfsf1C2wZdQ
b3YRO1gUPCzgEusyHr58LNfYDy4NRhx1zeepDf2npXr4z5VxbyoaOhjEhvWVBgkT
MQf/RspUdcPLE+DOGh6/v4TSvcfwfwJBUtvbqTI5B7d0dknyaox2jwhC1iViCHvc
9QIDAQAB
-----END PUBLIC KEY-----
", @"
<RSAKeyValue><Modulus>1R6PgZE6g6PLXOqoQ+evzKESvNUpk3FAvLogtdFpLcZSAV7Dme0UqoNQ/2wO99u+KsxJgGWT7WEf1+5is4xIG8H3wJGEHNv2nPiTSHcSToQd71JCVH2+a+CZQ9QEYRaUWLDZf6q4MSzH+h9SrEtDDFyAghtpQtLrXzuF/c5dr1fmBduGTkiq1J17DzjWCERnR1lnXCKq+pfsf1C2wZdQb3YRO1gUPCzgEusyHr58LNfYDy4NRhx1zeepDf2npXr4z5VxbyoaOhjEhvWVBgkTMQf/RspUdcPLE+DOGh6/v4TSvcfwfwJBUtvbqTI5B7d0dknyaox2jwhC1iViCHvc9Q==</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>
")]
    public void ConvertTypeTest(RsaKeyType targetType, string key, string expected)
    {
        var isPrivate = _rsaKey.IsPrivate(key);
        var actual = _rsaKey.ConvertType(key, targetType);
        if (targetType == RsaKeyType.Xml) expected = _rsaKey.ToXml(_rsaKey.ToParameter(expected));

        if (!isPrivate)
        {
            Assert.AreEqual(expected.Trim(), actual.Trim());
            return;
        }

        var actualPublic = _rsaKey.ExportPublicKey(actual);
        var expectedPublic = _rsaKey.ExportPublicKey(expected);
        Assert.AreEqual(expectedPublic.Trim(), actualPublic.Trim());
    }

    [TestMethod]
    [DataRow(@"
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQCLhqIW1GTMSbGtUCWcDPpjkr/H1kTvj1jj/NokDVpUARv8HG8k
0gKpDvIy5exGR6M0NDd9vhF04Ar2XRYDZsqFBaIDvNTDMApNGi50nDpEhR8ZhDkX
sKkTRc5kv5wEYzxTfwtD1H7DImS+F8VviaXJxqwY1ph5WIu/iQYJImuurQIDAQAB
AoGAFqZpg8lA/8Tq2hbLtDSLJUT6ayeGk1ky9ffjNb0RL9fqQhgfltuc4PLzMH4Q
yCvy+5OKepgzX0TLosjjvPOf5o6D7GB/oBOw8WAl68wf4Je/Ky4L2TD9iv5/8h9Y
IRenpxI4pvvA+2lfwH9Ijx5c+8f/pgNilZkCdJ+dNfb1NGECQQCOxM6yVQkAkVeF
eh4SErjt9/NLAA+M0nXuhbokURRRuAogoK49OEc1KrzfUJUkV/AIvod+B4m9gTP+
N0pdseupAkEA+i9oMAMeRwd0jlhGzT+Q/U25Ho+aRl/RoKbOw/O/x8WGwUuimVJL
dNahTpGGnL3POiC5Yo/OMVVvpvbwhoUtZQJAFLnJb+YcWnK/C+eAegsxwYofTaIC
n+TlrezH6wHCO2LGRZpN8SE8ZSGBLcIbBJ2ngP132fnqKxKYo60PJK7xkQJAP964
b4FsSl/Z3rkkoiN3RWOBPg8VKKAvqR7MrHPe4wZHZ7OCeDftMY/VsHQwdHV0oPdX
vJTP5AJWtb5XG1CGjQJAZgFFXc0nv5N3DMRkkb4LRgMZHTUnZrMOdPan5+x8Ll2h
YtjV1HtdEiInB5ZNDEZOF/+bpD0yQVrKChVXpeCHsQ==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCLhqIW1GTMSbGtUCWcDPpjkr/H
1kTvj1jj/NokDVpUARv8HG8k0gKpDvIy5exGR6M0NDd9vhF04Ar2XRYDZsqFBaID
vNTDMApNGi50nDpEhR8ZhDkXsKkTRc5kv5wEYzxTfwtD1H7DImS+F8VviaXJxqwY
1ph5WIu/iQYJImuurQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow(@"
-----BEGIN PRIVATE KEY-----
MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBANp7SKcGsV1Vgpcx
2i+5kwTvw/ordbTZWgRLPxvG2C3wTpPbCq3vmj27598sm08+vlaXWif7zbqGf2SK
qIuZinHToRmjCt6QuRCeA0nmH1sUU3uqLzgwcgM6cTI9AM2qa99l3sOK4lMmWbpB
rJ23BcqomjUy4uLdehgsXscqadj9AgMBAAECgYEAy5OYbNnVpowo9Mzk6xdVoIHw
8EhSk0L7l4itsyojARsrfKXbW5so82EFe3RK+xoRrQm2Xg9I8Qal6X8x8XIOBqv+
4/TVT+xFAALfwu8cX8iJbQm49lvkQKXP7GQ5/MBI+9XtgMyGY/d7AUC/hF+ku3Ia
hUSwhK5+CxS53UBPXYECQQD/xGDsc5m48gK1T61uoO+u7aBicvUVTbBhRYTCe5Hl
ZGjyqCgv/zrW/lcseZCXp+lEg7VFBmfG6/FeTkGNwebRAkEA2q42sIg1GUoGgZEA
VnZZmcL3f0gnr4AygnC2tYt5yaZpwJZJR8Hh5V22/qAebEnnf+pvIVNOh4GpIN1Y
BFnybQJAWbu7SZnxN9roqlYPAf5CuTuzhnbQl63PEQGD53vVHwcQbvoiR1yjdyR6
zybDXQHTLG+NHG9332mOIEkSZLq/0QJBAJWiF7H7wbmoOYN24LBJE05vZkMl8GHa
arVuwta+tXsR79LkAwii1hvIYGsizS5z84BHvfsjsdxvEHd4fb2cfpECQQC1rrbk
SmDtfHQx2nQTAWumpCduS14fnlKVbvsbWYI2Ag1fiuEnd66BN71IanAFq143fDSU
Y+mtXEsAjG5lBl12
-----END PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDae0inBrFdVYKXMdovuZME78P6
K3W02VoESz8bxtgt8E6T2wqt75o9u+ffLJtPPr5Wl1on+826hn9kiqiLmYpx06EZ
owrekLkQngNJ5h9bFFN7qi84MHIDOnEyPQDNqmvfZd7DiuJTJlm6QaydtwXKqJo1
MuLi3XoYLF7HKmnY/QIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow(@"
<RSAKeyValue>
  <DP>DEqhG4Q1WwSQP5nPI9vs0xzuZIxZcTyj1rRTT6zLCYGd1E1KELpVj7SlqtiiGg8z35VW9TLu+qJGx4dxH/BYEkoK0hzdMUOoqrEc2yrQOU6DCEQNntdWOap72IOtiogGZfI8AHALTkhhhDou4w4MGA4/Ub0hbaL+mFvfWFduUM8=</DP>
  <DQ>Nw1w+JCAY2lJDAtr/eCbMXuK3GmJE2zEhLmkNuL7NTHVIGRleaqktQd0ymJ6ToZwb7LTWCUuFtuhgRAzXX+QG0Q8dwHRuqwgQGRgRhI0cVrZx7tkUY8O2rCJgORDfIncTC6ehvaDWhVMhV17e9WSr5MSWwNJW9vDvH+IMoBYJbc=</DQ>
  <D>EyXZWr7MrS0qg3WW9ba6hEp9fVaSf16U2xHuteOB9yw9WdCtBXf4jjwUprkxICyLm8tCrlg2XQxC1jaJZtRqneuecefO+Jpg5q7j7xoM0phKPiM+QMxnTsJOexXjpr+A+b+s5vNDPthexKNKINDrqfmtAmBites4bm2/J/W2Ds4sgzlqXh8/GOH4xd7G14C+7VWGO9q10E9J9zk62M6OhhBxtCbJHiXcKK22m8HAgBjKCwyrYFgR+LgSWIrAhH99YDskUoZEOZT79p5EVffM/eXLqVVVEUcZDMY10b7cTxu6sQCXKLijkv0z3bE/ZGAAW1llOnWLSJCdm0uzG/g3SQ==</D>
  <Modulus>zYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQ==</Modulus>
  <Exponent>AQAB</Exponent>
  <InverseQ>FueFtUS6JpCW31IUgablpGCecG/DUiZVZXn+g+FkzGd7QQ4l5f2orss/Dmkzr8/4uDgB61nuSe6tZR1huZCSbtUwNgTe08trkJ+EQlF9ZpHuHEGqp3I4VqwiO3uWKaI2qqKQOXKNK+WOhMMmtpEypIXFwmzjx18VSNhm6V9CFRk=</InverseQ>
  <P>0L7h02AMr4avRutq+1xSdhDzKYLAno3nJVwDLyxtenARYBDf07ZiLvs/lb7rJjsrXwLBeoUWMdZM8I7NvaBXNfDQ1/odumav8+lqOfU2eMjlLz0XFCn/I0XSbOVm56AA7USoJWr8o2/mTRC5kHsRUjdI568DCT/EQKUHxpo2z7s=</P>
  <Q>/AqorP52EHJj2TzAFx2wBvzXPjklYB7CIejgMep4W6cgI+/d6l0AAxQv44RCePDDQLTkB6nXnr7SWzMi2WgOW3YmgdaPQRxTasrqkN0VQWMBLD8X5CmRefir2UKxmI0UJ8DQHmuXgBwowAgG5AgOirLnVyOcxJgASnQA9189iaM=</Q>
</RSAKeyValue>
", @"
<RSAKeyValue>
  <Modulus>zYSXSzi+V8lQxpDUc55n73CFJlKrz2k+XwmMx6kfjo6R/RD5IVSxBSRC3RxrY0RUiXhDe/h7po5gMrRD+jTjK0cJtPaPvU94ii3klIBKUeLayaRzNt3gb8IrU3K9iDlX2HL9Ae99R4J1GX5QKrmAKdB/ShmJXLzD8oHeh+BjeFgjjH5o3wojV8nTFyCe20K8s2rLvkktgbEBG0OPdgt1LwxGkHvjWFnSvkLrHHQm6+xdoqEqhERc+9e7I4FyW6l7lsiVq+Ovc6KV8jk+tvc+pRlSJBjEHLuPZzbbaUb0+wY7X1Q3Jc9vP/QrqASBKHSAED8x/MATh0QBaL+OaqBXEQ==</Modulus>
  <Exponent>AQAB</Exponent>
</RSAKeyValue>
")]
    public void IsKeyPairMatchTest(string privateKey, string publicKey)
    {
        Assert.IsTrue(_rsaKey.IsKeyPairMatch(privateKey, publicKey));
    }

    [TestMethod]
    [DataRow("123456", @"
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIICxjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIJYy7pdtCrkUCAggA
MBQGCCqGSIb3DQMHBAhPc8q242gtRQSCAoDPASOcwodvLTgPqP6gg1O6gy09IvUh
OdrxsjfI/ToKGKcMldIJdyuRkOfbdAA0vVAzm/9WhH92aF9+8GxPa8KlNsAEPnO8
DHCfTGLqIAL8CXAgLBG6ZNAdUuvLQoDlkyeiEUefMd0Nd9Y3xt+3wD91c93Bq85C
nu+iETqYijcccOB3nQ6Wx4KxuckEoMj/zz9T8yKmxhlsaWNxiKuSV6SP9oZXGBiB
Skpd9zMw1TlzobnJLoMlotblKpel5MT3WTee2J/tXBpZKA+v2XQE7x8EtSx9kw3i
tgnfpYxBSJbKzHz/HVk6gdERzsRD50fjoYgVdSqkyFuaFSjJvk1TO3gIkDg9hoB5
oE8fGZ+L+uRcKOYyjb33wm+y5ZMasFVdo7R6MZzPTaJ0tqOW1Fh+oslaawqrqXEK
29bEldURgQoA8xUrup1BhKz6Ger+UJ3BVH6ReO9PSXgWA7dZ93nbBmo4mqKn/eYv
wsbYUsIRaoN5N3w0LtjQCO1q2vygomFqOayGDwbUXzz+QDiyzrBpTnQUpm0NJj1R
7u1TTYjvMc3cDwCq+M8rpau/GOqFnX/z+DNsvpOMBaG6ZiQlOHFOxyOZxeAOKCjT
Q0M4zc3yMruIl+h/khGzspnQ8W/KdWVxr6H4Dvw73wWfU3ZRKOpxHJpW6UgnVEb8
3GMOND5ed7TrQAFC4rHV0orYPvCKKN3y0li5oo5OlHt9C/o5gcl7CFqdJfoM1/Jw
yXOfLtmDWLK3Kkrxez1M5kbyIpZQ3dEGgX/NE3HkrgE7YudF/i5y+FJa3AqdNHpy
VC6FB+W6oTZNbBmaybj3+tqPVoBehYYBh1v0T2vc3AhHdiBg7sc/Vfdw
-----END ENCRYPTED PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDMnY0QzzEh/wc8TCK5zVHa9HmS
LJWKLtVjOAS/Aa9UAAqDpr2xP1GFCrC3uVROY74QpCMmYJPcNNGrtu6CyvRlVq8O
GV2Dd1/N1H0JMJg9hQGdjXaJYS5buX4VpzGwpesIzpxWOihg0J7yn1MMmYExf/fK
1sysMS7p37ZvHkztbQIDAQAB
-----END PUBLIC KEY-----
")]
    [DataRow("123456", @"
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,2C34B76F127168F7

MVpBtSYMv4HNcx7g+UxMck9GIUEeZP54LeLuUAtUOW4DdDc5Esj+tXf/gMglpdtU
z/PLMJJR9TGna4LTE3DxC8AQDJVAo31Fna9NmAsS8Vmhw/Y5c9u6JaGaUf3ZO8+8
BF998GMB4IwKgtA4y3OzWiKSWdqblHkSfEgCkDWF1sylpTQYKXPHvCKfZN+Vfubg
fpXAlKeV13F95S/dt+m7NxHxNeKart3zlMCO2WeLF64vm63yn49NMDCkstik420B
KwMXzrSC4twXYC2GD2NJIFyZCGJLsV6nrg0tv2A9pfWJFxb+V2Rh5j/ckvEMyAIn
bCHxT5cO3d8rBjbe/r1Fv/STrdMFDNZVrIsERNhpss+RNbauz6X9gBj2X2BmWNlF
ngR7vWlaPLfgPsydu/2Als7tN2vyKAYEX5UJJvo2mEfE79+aIaNuUosAqNF/PMUV
p9590RgghBhTUIAb4X2voXTJKO6rsOaojKlfsL9/YqI1HYmlc3uXH/YYEJk+bef/
FPImkbJvabwvHn/wTqHZJqCWFxxlatHJH/M7QgoGeabSKuybeh/KURC+7JRwp5Tw
tNFUOCIyWabcQss3vVk5Edbvy1/0tPcahbuBj5F1fQ/S3uRgSzMYrsZIoK9LjWMY
kg/3jWyLd1TGsUnh66DBqk9G4HgOa6a6fDjcAdNdqEJDA77rUUCMmGQnn/rHtlMB
Hl2ozkO16veGTE4LjWSnetAKk8aWXz3QVRrsvDZi2iiakGpIzo2N59+eigHGyuq9
o74e2qHPooWbEOSW9LXZzg4x+SQeLHrvyLDDAA2EFsqQM0C4KVVmuw==
-----END RSA PRIVATE KEY-----
", @"
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOwWt7NvN1sqn/agyFVdazzLtr
Lkf0Lc+m6CADkakkkvW7O5oiJR2Q75sbtQjJ3EDTi1z0+IrXwIsV5wo+D4D7/3rF
nV3EtQFCzF77IZDnbi0pu77tNXx2viHFxaYcyfBO8Qdc4sKrw/oAPlSkVKWDX8yf
2Hy9BqgCRMNmmNTPiQIDAQAB
-----END PUBLIC KEY-----
")]
    public void IsKeyPairMatch(string password, string privateKey, string publicKey)
    {
        Assert.IsTrue(_rsaKey.IsKeyPairMatch(privateKey, publicKey, password));
    }
}
